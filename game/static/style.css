:root{
  --bg:#0b0e14; --neon:#ffe900; --cyan:#22d3ee; --glass:rgba(0,0,0,.45);
}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:#e6edf3;font-family:'Orbitron',system-ui;overflow:hidden}

/* 背景と上帯 */
.header{position:fixed;top:0;left:0;right:0;height:6px;
background:linear-gradient(90deg,var(--neon),#00fff0,var(--neon));
background-size:200% 100%;animation:flow 4s linear infinite;
box-shadow:0 0 18px rgba(255,233,0,.7);z-index:5}
@keyframes flow{to{background-position:200% 0}}

.stage-wrap{position:fixed;inset:6px 0 80px 0; display:grid; place-items:center}
#stage{display:block;width:100vw;height:100%}

/* 判定UI */
.judge-ui{position:absolute;inset:0;pointer-events:none}
.judge-line{position:absolute;left:0;right:0;bottom:10%;height:3px;
background:var(--cyan); box-shadow:0 0 18px var(--cyan)}
.big-combo{position:absolute;left:50%;bottom:14%;transform:translateX(-50%);
font-size: clamp(28px, 6vw, 64px); font-weight:700; letter-spacing:.04em;
text-shadow:0 0 18px rgba(255,233,0,.8); color:var(--neon); mix-blend-mode:screen}
.fastslow{position:absolute;left:50%;bottom:22%;transform:translateX(-50%);
font-size:clamp(12px,2.2vw,18px); color:#fff; opacity:.9}

/* HUD */
.hud{position:fixed;left:12px;right:12px;bottom:12px;display:flex;gap:12px;
align-items:center;padding:10px 12px;border-radius:12px}
.glass{background:linear-gradient(180deg, rgba(0,0,0,.65), rgba(0,0,0,.35));
border:1px solid rgba(255,233,0,.25);box-shadow:0 0 16px rgba(255,233,0,.2);backdrop-filter:blur(6px)}
.flex-1{flex:1}
.btn{background:transparent;color:#000;border:2px solid var(--neon);padding:10px 14px;border-radius:10px;cursor:pointer}
.btn.neon{background:var(--neon);box-shadow:0 0 16px rgba(255,233,0,.6)}
.btn.sm{font-size:12px;padding:6px 8px;border-color:#888;color:#e6edf3}
.badge{padding:8px 12px;border-radius:10px;background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.08)}

/* 進行バー */
.progress{position:fixed;left:12px;right:12px;bottom:64px;height:6px;background:#141922;border-radius:6px;overflow:hidden}
.progress .bar{height:100%;width:0;background:var(--neon);box-shadow:0 0 12px rgba(255,233,0,.7)}

/* レーンとノーツの見た目（Canvasで描く色だけ指定） */
:root{ --laneGlow: rgba(255,255,255,.18); --noteFill: #ffe900; }
.nav-btn {
  font-size: 1.5rem;
  display: flex;
  align-items: center;
  justify-content: center;
  background: none;
  color: #ffe900;
  border: none;
  border-radius: 0;
  width: 48px;
  height: 48px;
  margin: 0 18px;
  cursor: pointer;
  box-shadow: none;
  transition: color 0.2s;
  z-index: 3;
  padding: 0;
}
.nav-btn span {
  display: inline-block;
  line-height: 1;
  font-size: 1.5em;
  vertical-align: middle;
}
.nav-btn:hover {
  color: #fff200;
  text-shadow: 0 0 8px #ffe90099;
}
.nav-btn.left { order: -1; }
.nav-btn.right { order: 2; }
body.orbitron, body.cool, body.hardbass {
  font-family: 'Orbitron', 'Bebas Neue', 'sans-serif';
}
body.cool {
  background: #0b0e14;
  color: #0ff;
}
body.hardbass {
  background: #111;
  color: #ff0;
}
.song-select {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
  position: relative;
}
.song-carousel {
  display: flex;
  align-items: center;
  margin-top: 80px;
  z-index: 2;
}
.song {
  text-align: center;
  transition: transform 0.3s, opacity 0.3s;
  color: inherit;
}
.song.prev, .song.next {
  opacity: 0.5;
  transform: scale(0.8);
}
.song.active {
  transform: scale(1.2);
  border: 3px solid #0ff;
  padding: 10px;
  box-shadow: 0 0 20px #0ff;
  background: rgba(0,0,0,0.7);
}
body.hardbass .song.active {
  border-color: #ff0;
  box-shadow: 0 0 20px #ff0;
}
.song img {
  width: 180px;
  height: 180px;
  object-fit: cover;
  border-radius: 16px;
  margin-bottom: 10px;
}
.neon-frame {
  border: 3px solid #0ff;
  border-radius: 16px;
  padding: 40px 30px;
  font-size: 2em;
  color: #0ff;
  background: rgba(0,0,0,0.5);
  box-shadow: 0 0 20px #0ff;
}
body.hardbass .neon-frame {
  border-color: #ff0;
  color: #ff0;
  box-shadow: 0 0 20px #ff0;
}
.play-btn {
  margin-top: 20px;
  font-size: 1.5rem;
  padding: 10px 30px;
  border: 2px solid #ff0;
  background: transparent;
  color: #ff0;
  cursor: pointer;
  transition: all 0.2s;
  z-index: 2;
}
.play-btn:hover {
  background: #ff0;
  color: #000;
}
.side-panel {
  position: absolute;
  right: 40px;
  top: 120px;
  background: rgba(0,0,0,0.7);
  padding: 24px 32px;
  border-radius: 16px;
  font-size: 1.1em;
  min-width: 220px;
  z-index: 2;
  color: inherit;
}
.flag.ru {
  display: inline-block;
  width: 32px; height: 20px;
  background: linear-gradient(to bottom, #fff 33%, #0033a0 33% 66%, #d52b1e 66%);
  border: 2px solid #fff;
  margin-left: 8px;
  animation: blink 0.5s steps(1) infinite alternate;
}
.flag.ua {
  display: inline-block;
  width: 32px; height: 20px;
  background: linear-gradient(to bottom, #0057b7 50%, #ffd700 50%);
  border: 2px solid #fff;
  margin-left: 8px;
  animation: blink 0.5s steps(1) infinite alternate;
}
@keyframes blink {
  0% { opacity: 1; }
  100% { opacity: 0.3; }
}
#bgfx {
  position: fixed;
  left: 0; top: 0;
  width: 100vw; height: 100vh;
  z-index: 0;
  pointer-events: none;
}
*{box-sizing:border-box}body{margin:0;background:#0b0e14;color:#e6edf3;font-family:ui-sans-serif,system-ui}
.hud{display:flex;gap:12px;align-items:center;padding:10px 12px;background:rgba(255,255,255,.03);backdrop-filter:blur(4px);position:sticky;top:0}
.btn{background:#2563eb;color:#fff;border:0;padding:10px 14px;border-radius:10px;cursor:pointer}
.btn.sm{padding:6px 8px;font-size:12px}
#stage{display:block;width:100vw;height:72vh;background:#0f1320}

/* 追加CSS: 曲選択画面用 */
.song-item {
  margin: 1em 0;
  padding: 1em;
  background: #f0f4f8;
  border-radius: 8px;
  font-size: 1.2em;
  display: flex;
  align-items: center;
  justify-content: space-between;
  max-width: 400px;
}
.song-item button {
  font-size: 1em;
  padding: 0.5em 1.2em;
  border-radius: 6px;
  background: #22d3ee;
  color: #fff;
  border: none;
  cursor: pointer;
  transition: background 0.2s;
}
.song-item button:hover {
  background: #0ea5e9;
}
.play {
  margin-top: 20px;
  font-size: 1.5rem;
  padding: 10px 30px;
  border: 2px solid #ff0;
  background: transparent;
  color: #ff0;
  cursor: pointer;
  transition: all 0.2s;
  z-index: 2;
}
.play:hover {
  background: #ff0;
  color: #000;
}
.song-row {
  display: flex;
  align-items: center;
  gap: 28px;
  margin-top: 12vh;
}
.song-card {
  width: min(38vw, 420px);
  aspect-ratio: 4/3;
  border-radius: 18px;
  background: rgba(0,0,0,.35);
  border: 2px solid rgba(255,233,0,.25);
  box-shadow: 0 0 0 rgba(0,0,0,0);
  color: #9ca3af;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  transition: transform .25s ease, box-shadow .25s ease, border-color .25s ease, color .25s ease, filter .25s ease;
  backdrop-filter: blur(6px);
}
.song-card .title {
  font-size: clamp(22px,3.2vw,34px);
  letter-spacing: .02em;
}
.song-card .cover {
  width: 100%;
  height: 100%;
  aspect-ratio: 1/1;
  border-radius: 16px;
  object-fit: cover;
  border: 2px solid rgba(255,233,0,.35);
  margin-bottom: 0;
  background: linear-gradient(135deg, #222, #111);
  box-sizing: border-box;
}
.song-card.prev, .song-card.next {
  transform: translateZ(-120px) scale(.86);
  opacity: .65;
}
.song-card.active {
  color: #fff;
  border-color: var(--neon);
  box-shadow: 0 0 22px rgba(255,233,0,.55), inset 0 0 18px rgba(255,233,0,.15);
  transform: translateZ(0) scale(1.04);
  animation: pulse .8s ease-in-out infinite;
}
@keyframes pulse {
  0%,100%{ box-shadow: 0 0 18px rgba(255,233,0,.45), inset 0 0 12px rgba(255,233,0,.12); }
  50%    { box-shadow: 0 0 38px rgba(255,233,0,.9),  inset 0 0 20px rgba(255,233,0,.2); }
}
